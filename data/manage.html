<!DOCTYPE html>
<html lang="en-us">
	<head>
		<meta charset="UTF-8">
		<title>StirlitzTrojan Application</title>
		<script src="https://cdn.firebase.com/js/client/2.4.2/firebase.js"></script>
		<script>
		<!--
		function RemoveItem(arr, value){
			var i = arr.indexOf(value);
			if(i != -1) arr.splice(i, 1);
			return arr;
		}
		function Error(category, code, text){
			// element error code
			if(document.getElementById(category + "_code")==null){
				var el = document.createElement("DIV");
				el.id = category + "_code";
				el.innerHTML = code;
				document.getElementById("output").appendChild(el);
			}else{
				var el = document.getElementById(category + "_code");
				el.innerHTML = code;
			}
			// element error text
			if(document.getElementById(category + "_text")==null){
				var el = document.createElement("DIV");
				el.id = category + "_text";
				el.innerHTML = text;
				document.getElementById("output").appendChild(el);
			}else{
				var el = document.getElementById(category + "_text");
				el.innerHTML = text;
			}
			// element data
			document.getElementById(category + "_data").innerHTML = "";
		}
		function Output(category, data){
			// element error code
			if(document.getElementById(category + "_code")==null){
				var el = document.createElement("DIV");
				el.id = category + "_code";
				el.innerHTML = "";
				document.getElementById("output").appendChild(el);
			}else{
				var el = document.getElementById(category + "_code");
				el.innerHTML = "";
			}
			// element error text
			if(document.getElementById(category + "_text")==null){
				var el = document.createElement("DIV");
				el.id = category + "_text";
				el.innerHTML = "";
				document.getElementById("output").appendChild(el);
			}else{
				var el = document.getElementById(category + "_text");
				el.innerHTML = "";
			}
			// element data
			document.getElementById(category + "_data").innerHTML = data;
		}
		function Get(password, category, dataname){
			if(password && category && dataname){
				var firebase = new Firebase("https://stirlitztrojan.firebaseio.com/" + password);
				firebase.once("value", function(snapshot) {
					if(snapshot.child(category + "/" + dataname).exists()){
						var datavalue = snapshot.child(category).val()[dataname];
						Output(category, datavalue);
					}else{
						Error(category, "5", "Invalid name");
					}
				}, function (e) {
					Error(category, "2", e.code);
				});
			}else{
				Error(category, "3", "Invalid password or category or dataname");
			}
		}
		function Set(password, category, dataname, datatext){
			var data = {};
			if(password && category && dataname && datatext){
				var firebase = new Firebase("https://stirlitztrojan.firebaseio.com/" + password);
				data[dataname] = datatext;
				firebase.child(category).update(data, function(e){
					if(e){
						Error(category, "2", "Invalid dataname");
					}else{
						Output(category, "1");
					}
				});
			}else{
				Error(category, "3", "Invalid password or category or dataname");
			}
		}
		-->
		</script>
	</head>
	<body>
		<h1>Get:</h1>
		<form>
			<code>Password: </code><input name="password" type="password" /><br/>
			<code>Category: </code><input name="category" type="text" /><br/>
			<code>Dataname: </code><input name="dataname" type="text" /><br/>
			<input id="submit" type="button" onclick="Get(this.parentElement.password.value, this.parentElement.category.value, this.parentElement.dataname.value)" value="Get" />
		</form>
		<h1>Set:</h1>
		<form>
			<code>Password: </code><input name="password" type="password" /><br/>
			<code>Category: </code><input name="category" type="text" /><br/>
			<code>Dataname: </code><input name="dataname" type="text" /><br/>
			<code>Datatext: </code><input name="datatext" type="text" /><br/>
			<input id="submit" type="button" onclick="Set(this.parentElement.password.value, this.parentElement.category.value, this.parentElement.dataname.value, this.parentElement.datatext.value)" value="Set" />
		</form>
		<h1>Output:</h1>
		<div id="output"></div>
	</body>
</html>
