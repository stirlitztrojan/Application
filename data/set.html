<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>StirlitzTrojan Application</title>
    <script src="firebase.js"></script>
    <script src="firebase-auth-client.js"></script>
  </head>
  <body>
    <div id="data"></div>
    <div id="err"></div>
    <script>
    <!--
    window.onerror = function(message, source, lineno, colno, error){
      document.getElementById("err").innerHTML = "1";
    }
    var url = window.location.href;
    if(url.indexOf("?") != -1){
      var database = "0";
      var type = "0";
      var data = {};
      var params = url.split("?")[1].split(";");
      if(params.length >= 1){
        for(var i = 0; i < params.length; i++){
          var param = params[i];
          console.log(param);
          if(param.indexOf("=")!=-1){
            var name = param.split("=")[0];
            var value = param.split("=")[1];
            if(name == "type"){
              type = value;
              params = params.splice(params.indexOf(param), 1);
            }
            if(name == "database"){
              database = value;
              params = params.splice(params.indexOf(param), 1);
            }
          }
        }
        if(type == "0" || database == "0"){
          document.getElementById("err").innerHTML = "4";
        }else{
          var firebase = new Firebase("https://" + database + ".firebaseio.com/");
          firebase.child(type).update(data, function(e){
            if(e){
              document.getElementById("err").innerHTML = "2";
            }else{
              document.getElementById("data").innerHTML = "1";
              document.getElementById("err").innerHTML = "0";
            }
          });
        }
      }else{
        document.getElementById("err").innerHTML = "3";
      }
    }else{
      document.getElementById("err").innerHTML = "3";
    }
    -->
    </script>
  </body>
</html>
